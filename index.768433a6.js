const t=new class{deepCopy(t){return t.map(t=>t.slice())}constructor(t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]){this.board=t?this.deepCopy(t):this.deepCopy([[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]),this.initialBoardState=this.deepCopy(this.board),this.score=0,this.status="idle",this.rows=4,this.columns=4,console.log(t)}setNumber(){let t,e=!1;for(t=.1>Math.random()?4:2;!e;){let s=Math.floor(Math.random()*this.rows),i=Math.floor(Math.random()*this.columns);0===this.board[s][i]&&(this.board[s][i]=t,e=!0)}}slide(t){let e=t.filter(t=>0!==t),s=[];for(let t=0;t<e.length;t++)e[t]===e[t+1]?(s.push(2*e[t]),this.score+=2*e[t],t++):s.push(e[t]);return s}isWin(){return JSON.stringify(this.board).includes(2048)}canMove(){let t=!1,e=!1;for(let s=0;s<this.rows;s++)for(let i=0;i<this.columns-1;i++)this.board[s][i]||(e=!0),this.board[s][i]===this.board[s][i+1]&&(t=!0);for(let e=0;e<this.columns;e++)for(let s=0;s<this.rows-1;s++)this.board[s][e]===this.board[s+1][e]&&(t=!0);return!!t||!!e}processRow(t,e){e&&t.reverse();let s=this.slide(t);for(;s.length<this.columns;)s.push(0);return e&&s.reverse(),s}finalizeMove(t){t!==JSON.stringify(this.board)&&this.setNumber(),this.isWin()&&(this.status="win"),this.canMove()||(this.status="lose")}handleRow(t){let e="right"===t;for(let t=0;t<this.rows;t++){let s=this.board[t],i=this.processRow(s,e);this.board[t]=i}}handleColumn(t){let e="down"===t;for(let t=0;t<this.columns;t++){let s=[];for(let e=0;e<this.rows;e++)s.push(this.board[e][t]);let i=this.processRow(s,e);for(let e=0;e<this.rows;e++)this.board[e][t]=i[e]}}moveLeft(){if("playing"!==this.status)return;let t=JSON.stringify(this.board);this.handleRow("left"),this.finalizeMove(t)}moveRight(){if("playing"!==this.status)return;let t=JSON.stringify(this.board);this.handleRow("right"),this.finalizeMove(t)}moveUp(){if("playing"!==this.status)return;let t=JSON.stringify(this.board);this.handleColumn("up"),this.finalizeMove(t)}moveDown(){if("playing"!==this.status)return;let t=JSON.stringify(this.board);this.handleColumn("down"),this.finalizeMove(t)}getScore(){return this.score}getState(){return this.board}getStatus(){return this.status}start(){"idle"===this.status&&(this.status="playing",this.setNumber(),this.setNumber())}restart(){this.status="idle",this.score=0,this.board=this.initialBoardState.map(t=>t.slice())}}([[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]),e=document.querySelector(".button"),s=document.querySelector(".game-score"),i=document.querySelector(".message-lose"),r=document.querySelector(".message-win"),o=document.querySelector(".message-start"),a=(()=>{let t=[];return document.querySelectorAll(".game-field .field-row").forEach((e,s)=>{let i=[];e.querySelectorAll(".field-cell").forEach((t,e)=>{i.push(t)}),t.push(i)}),t})(),l=()=>{s.textContent=t.getScore();let e=t.getState();for(let t=0;t<4;t++)for(let s=0;s<4;s++){let i=e[t][s],r=a[t][s];r.className="",r.classList.add("field-cell"),i?(r.innerText=i,r.classList.add(`field-cell--${i}`)):r.innerText=""}"win"===t.getStatus()&&r.classList.remove("hidden"),"lose"===t.getStatus()&&i.classList.remove("hidden")},h=e=>{switch(e){case"ArrowLeft":t.moveLeft();break;case"ArrowRight":t.moveRight();break;case"ArrowUp":t.moveUp();break;case"ArrowDown":t.moveDown()}l()};e.addEventListener("click",()=>{"idle"===t.getStatus()?(e.classList.remove("start"),e.classList.add("restart"),e.textContent="Reset",o.classList.add("hidden"),t.start()):(e.classList.remove("restart"),e.classList.add("start"),e.textContent="Start",o.classList.remove("hidden"),i.classList.add("hidden"),r.classList.add("hidden"),t.restart()),l()}),document.addEventListener("keydown",e=>{"playing"===t.getStatus()&&h(e.key)});
//# sourceMappingURL=index.768433a6.js.map
