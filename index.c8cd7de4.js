var t,e,s,i,r,o,a,n,u,l;e=new/*#__PURE__*/(function(){var t;function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];(function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")})(this,e),this.board=t?this.deepCopy(t):this.deepCopy([[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]),this.initialBoardState=this.deepCopy(this.board),this.score=0,this.status="idle",this.rows=4,this.columns=4,console.log(t)}return t=[{key:"deepCopy",value:function(t){return t.map(function(t){return t.slice()})}},{key:"setNumber",value:function(){var t,e=!1;for(t=.1>Math.random()?4:2;!e;){var s=Math.floor(Math.random()*this.rows),i=Math.floor(Math.random()*this.columns);0===this.board[s][i]&&(this.board[s][i]=t,e=!0)}}},{key:"slide",value:function(t){for(var e=t.filter(function(t){return 0!==t}),s=[],i=0;i<e.length;i++)e[i]===e[i+1]?(s.push(2*e[i]),this.score+=2*e[i],i++):s.push(e[i]);return s}},{key:"isWin",value:function(){return JSON.stringify(this.board).includes(2048)}},{key:"canMove",value:function(){for(var t=!1,e=!1,s=0;s<this.rows;s++)for(var i=0;i<this.columns-1;i++)this.board[s][i]||(e=!0),this.board[s][i]===this.board[s][i+1]&&(t=!0);for(var r=0;r<this.columns;r++)for(var o=0;o<this.rows-1;o++)this.board[o][r]===this.board[o+1][r]&&(t=!0);return!!t||!!e}},{key:"processRow",value:function(t,e){e&&t.reverse();for(var s=this.slide(t);s.length<this.columns;)s.push(0);return e&&s.reverse(),s}},{key:"finalizeMove",value:function(t){t!==JSON.stringify(this.board)&&this.setNumber(),this.isWin()&&(this.status="win"),this.canMove()||(this.status="lose")}},{key:"handleRow",value:function(t){for(var e="right"===t,s=0;s<this.rows;s++){var i=this.board[s],r=this.processRow(i,e);this.board[s]=r}}},{key:"handleColumn",value:function(t){for(var e="down"===t,s=0;s<this.columns;s++){for(var i=[],r=0;r<this.rows;r++)i.push(this.board[r][s]);for(var o=this.processRow(i,e),a=0;a<this.rows;a++)this.board[a][s]=o[a]}}},{key:"moveLeft",value:function(){if("playing"===this.status){var t=JSON.stringify(this.board);this.handleRow("left"),this.finalizeMove(t)}}},{key:"moveRight",value:function(){if("playing"===this.status){var t=JSON.stringify(this.board);this.handleRow("right"),this.finalizeMove(t)}}},{key:"moveUp",value:function(){if("playing"===this.status){var t=JSON.stringify(this.board);this.handleColumn("up"),this.finalizeMove(t)}}},{key:"moveDown",value:function(){if("playing"===this.status){var t=JSON.stringify(this.board);this.handleColumn("down"),this.finalizeMove(t)}}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.board}},{key:"getStatus",value:function(){return this.status}},{key:"start",value:function(){"idle"===this.status&&(this.status="playing",this.setNumber(),this.setNumber())}},{key:"restart",value:function(){this.status="idle",this.score=0,this.board=this.initialBoardState.map(function(t){return t.slice()})}}],function(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}(e.prototype,t),e}())([[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]),s=document.querySelector(".button"),i=document.querySelector(".game-score"),r=document.querySelector(".message-lose"),o=document.querySelector(".message-win"),a=document.querySelector(".message-start"),t=[],document.querySelectorAll(".game-field .field-row").forEach(function(e,s){var i=[];e.querySelectorAll(".field-cell").forEach(function(t,e){i.push(t)}),t.push(i)}),n=t,u=function(){i.textContent=e.getScore();for(var t=e.getState(),s=0;s<4;s++)for(var a=0;a<4;a++){var u=t[s][a],l=n[s][a];l.className="",l.classList.add("field-cell"),u?(l.innerText=u,l.classList.add("field-cell--".concat(u))):l.innerText=""}"win"===e.getStatus()&&o.classList.remove("hidden"),"lose"===e.getStatus()&&r.classList.remove("hidden")},l=function(t){switch(t){case"ArrowLeft":e.moveLeft();break;case"ArrowRight":e.moveRight();break;case"ArrowUp":e.moveUp();break;case"ArrowDown":e.moveDown()}u()},s.addEventListener("click",function(){"idle"===e.getStatus()?(s.classList.remove("start"),s.classList.add("restart"),s.textContent="Reset",a.classList.add("hidden"),e.start()):(s.classList.remove("restart"),s.classList.add("start"),s.textContent="Start",a.classList.remove("hidden"),r.classList.add("hidden"),o.classList.add("hidden"),e.restart()),u()}),document.addEventListener("keydown",function(t){"playing"===e.getStatus()&&l(t.key)});
//# sourceMappingURL=index.c8cd7de4.js.map
